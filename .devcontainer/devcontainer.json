{
  "name": "Java Spring Boot Server",
  "dockerComposeFile": "docker-compose.yml",
  "service": "app",
  "workspaceFolder": "/workspaces/demo-playground",
  
  "forwardPorts": [8083],

  "features": {
    "ghcr.io/devcontainers/features/github-cli": {}
  },

  "portsAttributes": {
    "8083": {
      "label": "Spring Boot App",
      "onAutoForward": "notify"
    }
  },

  "postCreateCommand": {
    "build-project": "cd app && mvn clean install -DskipTests"
  },
  
  "postAttachCommand": {
    "start-and-poll": "cd app && (mvn spring-boot:run &) && echo 'Server starting in background...' && while ! ss -tln | grep -q ':8083'; do echo 'Waiting for port 8083 to be ready...'; sleep 2; done && echo 'Port 8083 is ready! Setting to public.' && gh codespace ports visibility 8083:public -c \"$CODESPACE_NAME\""
  },

  "customizations": {
    "vscode": {
      "extensions": [],
      "settings": {}
    },
    "codespaces": {
      "openFiles": [
        "README.md",
        "app/src/main/resources/static/.well-known/hash.txt"
      ]
    }
  },
  
  "remoteUser": "vscode"
}
